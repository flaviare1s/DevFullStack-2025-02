<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"> <!-- Usa UTF‚Äë8 para suportar todos os caracteres do portugu√™s -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Garante responsividade em telas m√≥veis -->
  <title>Assincronismo em JavaScript ‚Äì Promise, Fetch & Async/Await</title>
  <style>
    /* ======================================
       RESET B√ÅSICO
       ----------------
       Remove margens/paddings padr√£o e padroniza box-sizing para evitar surpresas no layout
       ====================================== */
    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    /* ======================================
       ESTILOS GERAIS
       ----------------
       Define fonte, cores e espa√ßamento da p√°gina
       ====================================== */
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
      color: #333;
      padding: 2rem;
      line-height: 1.6;
    }
    h1 { text-align: center; margin-bottom: 1.5rem; }
    section {
      background: #fff;
      padding: 1rem;
      margin-bottom: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    section h2 { margin-bottom: 0.5rem; color: #007acc; font-size: 1.2rem; }
    button {
      padding: 0.5rem 1rem; margin-top: 0.5rem;
      background: #007acc; color: #fff; border: none; border-radius: 4px;
      cursor: pointer; transition: background 0.2s;
    }
    button:hover, button:focus { background: #005fa3; }
    pre {
      background: #272822; color: #f8f8f2;
      padding: 1rem; border-radius: 4px; overflow-x: auto;
      margin-top: 0.5rem; font-family: 'Courier New', monospace;
    }
  </style>
</head>
<body>
  <h1>Assincronismo em JavaScript</h1>

  <!-- ======================================
       EXEMPLO 1: SIMULA√á√ÉO DE PROMISE
       ----------------
       Uma Promise representa um valor que pode estar dispon√≠vel agora, no futuro ou nunca.
       Estados de uma Promise:
       ‚Ä¢ pending (pendente) ‚Äî opera√ß√£o em andamento
       ‚Ä¢ fulfilled (cumprida) ‚Äî opera√ß√£o completou com sucesso ‚Üí dispara .then()
       ‚Ä¢ rejected (rejeitada) ‚Äî opera√ß√£o falhou ‚Üí dispara .catch()
       ====================================== -->
  <section>
    <h2>1. Simula√ß√£o de Promise</h2>
    <button id="btnPromise">Executar Promise</button>
    <pre id="outPromise">// Clique para iniciar</pre>
  </section>

  <!-- ======================================
       EXEMPLO 2: FETCH COM .then()/catch()
       ----------------
       fetch() retorna uma Promise que resolve com um objeto Response.
       Podemos encadear then() para processar dados e catch() para erros.
       ====================================== -->
  <section>
    <h2>2. Fetch usando <code>.then()</code></h2>
    <button id="btnFetchThen">Iniciar Fetch (.then)</button>
    <pre id="outFetchThen">// Clique para buscar via .then()</pre>
  </section>

  <!-- ======================================
       EXEMPLO 3: FETCH COM ASYNC/AWAIT
       ----------------
       async/await √© sintaxe a√ßucarada sobre Promises.
       Uma fun√ß√£o async retorna sempre uma Promise.
       await faz a execu√ß√£o ‚Äúpausar‚Äù at√© a Promise resolver/rejeitar.
       ====================================== -->
  <section>
    <h2>3. Fetch usando <code>async/await</code></h2>
    <button id="btnFetchAsync">Iniciar Fetch (async/await)</button>
    <pre id="outFetchAsync">// Clique para buscar via async/await</pre>
  </section>

  <script>
    // API p√∫blica do ViaCEP para demonstra√ß√£o
    const CEP_URL = 'https://viacep.com.br/ws/01001000/json/';

    /**
     * simulatePromise(valor, ms)
     * @param {*} valor ‚Äî conte√∫do para resolver ou falsy para rejeitar
     * @param {number} ms ‚Äî tempo de delay em milissegundos
     * @returns {Promise<string>} ‚Äî resolve ou rejeita ap√≥s ms
     */
    function simulatePromise(valor, ms) {
      return new Promise((resolve, reject) => {
        // setTimeout simula opera√ß√£o ass√≠ncrona (ex: leitura de arquivo ou consulta em DB)
        setTimeout(() => {
          if (valor) {
            // resolve dispara callbacks em .then()
            resolve('‚úÖ Sucesso: ' + valor);
          } else {
            // reject dispara callbacks em .catch()
            reject('üö´ Erro: valor inv√°lido');
          }
        }, ms);
      });
    }

    // Ao clicar, executa simulatePromise e demonstra .then() e .catch()
    document.getElementById('btnPromise').addEventListener('click', () => {
      const out = document.getElementById('outPromise');
      out.textContent = '‚è≥ Executando simulatePromise...';

      simulatePromise('Ol√°, Mundo!', 2000)
        .then(resultado => {
          // √â chamado quando resolve() √© executado
          out.textContent = resultado;
        })
        .catch(erro => {
          // √â chamado quando reject() √© executado ou erro ocorre dentro do executor
          out.textContent = erro;
        });
    });

    // Exemplo de fetch com then/catch ‚Äî m√©todo tradicional de lidar com Promises
    document.getElementById('btnFetchThen').addEventListener('click', () => {
      const out = document.getElementById('outFetchThen');
      out.textContent = '‚è≥ Buscando via fetch .then()...';

      fetch(CEP_URL) // retorna Promise<Response>
        .then(response => {
          // response.ok indica status HTTP 200‚Äì299
          if (!response.ok) throw new Error('HTTP ' + response.status);
          return response.json(); // retorna Promise<object>
        })
        .then(data => {
          // data √© o JSON parseado
          out.textContent = JSON.stringify(data, null, 2);
        })
        .catch(error => {
          // Captura erros de rede, parsing ou lan√ßados acima
          out.textContent = 'üö´ ' + error;
        });
    });

    // Exemplo de fetch com async/await ‚Äî sintaxe mais linear e clara
    document.getElementById('btnFetchAsync').addEventListener('click', async () => {
      const out = document.getElementById('outFetchAsync');
      out.textContent = '‚è≥ Buscando via async/await...';

      try {
        // await faz a fun√ß√£o esperar a Promise do fetch resolver ou rejeitar
        const response = await fetch(CEP_URL);
        if (!response.ok) {
          // lan√ßar erro faz pular diretamente para catch
          throw new Error('HTTP ' + response.status);
        }
        // await tamb√©m espera a convers√£o para JSON
        const data = await response.json();
        out.textContent = JSON.stringify(data, null, 2);
      } catch (error) {
        // Captura qualquer erro de rede, HTTP ou parsing
        out.textContent = 'üö´ ' + error;
      }
    });
  </script>
</body>
</html>